<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:jsf="jakarta.faces"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>E-Commerce Store</title>
    <h:outputStylesheet library="css" name="style.css"/>
</h:head>

<h:body>
    <div class="container">
        <!-- Header -->
        <p:toolbar>
            <f:facet name="left">
                <h:outputText value="E-Commerce Store" style="font-size: 24px; font-weight: bold;"/>
            </f:facet>
            <f:facet name="right">
                <h:panelGroup rendered="#{userBean.loggedIn}">
                    <h:outputText value="Welcome, #{userBean.currentUser.firstName}!" style="margin-right: 10px;"/>
                    <p:button value="Cart (#{cartBean.cartItemCount})" outcome="cart"/>
                    <p:commandButton value="Logout" action="#{userBean.logout}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!userBean.loggedIn}">
                    <p:button value="Login" outcome="login"/>
                    <p:button value="Register" outcome="register"/>
                </h:panelGroup>
            </f:facet>
        </p:toolbar>

        <!-- Navigation -->
        <p:menubar>
            <p:menuitem value="Home" outcome="index"/>
            <p:menuitem value="Products" outcome="products"/>
            <p:submenu label="Categories">
                <p:menuitem value="Electronics" action="#{productBean.selectCategory(1)}" outcome="products"/>
                <p:menuitem value="Clothing" action="#{productBean.selectCategory(2)}" outcome="products"/>
                <p:menuitem value="Books" action="#{productBean.selectCategory(3)}" outcome="products"/>
            </p:submenu>
            <h:panelGroup rendered="#{userBean.admin}">
                <p:menuitem value="Admin Panel" outcome="admin"/>
            </h:panelGroup>
        </p:menubar>

        <!-- Main Content -->
        <div class="content">
            <h1>Welcome to Our E-Commerce Store</h1>
            <p>Discover amazing products at great prices!</p>
            
            <!-- Featured Products -->
            <h2>Featured Products</h2>
            <h:form id="mainForm">
                <p:dataGrid value="#{productBean.products}" var="product" columns="3" rows="6" paginator="true" 
                           paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">
                <p:panel header="#{product.name}" style="text-align: center; margin: 5px;">
                    <h:graphicImage value="#{product.imageUrl}" style="width: 200px; height: 150px;" 
                                  rendered="#{product.imageUrl != null}"/>
                    <h:outputText value="#{product.description}" style="display: block; margin: 10px 0;"/>
                    <h:outputText value="Price: DH#{product.price}" style="font-weight: bold; color: green; display: block; margin: 10px 0;"/>
                    <h:outputText value="Stock: #{product.stock}" style="display: block; margin: 10px 0;"/>
                    <h:panelGroup rendered="#{userBean.loggedIn and product.stock > 0}">
                        <p:commandButton value="Add to Cart" 
                                        action="#{cartBean.addToCart(product.id, 1)}" 
                                        update=":mainForm" 
                                        styleClass="ui-button-success"/>
                    </h:panelGroup>
                    <p:commandButton value="View Details" 
                                    action="#{productBean.viewProduct(product.id)}" 
                                    styleClass="ui-button-info"/>
                </p:panel>
            </p:dataGrid>
            </h:form>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Â© LSI-FSTT 2025 - ECommerce Store. All rights reserved.</p>
        </div>
    </div>
</h:body>
</html>
